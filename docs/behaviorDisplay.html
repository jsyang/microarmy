<html><head><title>Behavior Tree Editor</title><style>
.node
{
    outline: solid 0.2em #000;
    padding: 1em;
    margin-right: 0.2em;
    vertical-align: middle;
    text-align: center;
    font-family: monospace;
    font-size: 1em;
    font-weight: bold;
}

.header
{
    text-align: center;
    font-family: monospace;
}

.header-bracket
{
    border: 0.1em solid #000;
    border-bottom: none;
}

td
{
    vertical-align: top;
}

body
{
    padding-top: 1em;
}

</style></head><body></body><script src="jquery-1.8.3.min.js"></script><script src="entity_behavior.js"></script><script>
function drawTree(tree) {
    if(typeof tree !== 'object') {
        tree = Behavior.ConvertShortHand(tree);
    }

    var $tree;

    switch(tree.id) {
      case 'selector':  // Quit on first true
      case 'sequence':  // Quit on first false
        $tree = $(
            '<table>'+
                '<tr><td colspan="'+tree.children.length+'" class="header">'+tree.id.substr(0,3).toUpperCase()+'<div class="header-bracket">&nbsp;</div></td></tr>'+
                '<tr></tr>'+
            '</table>');
        var $tr = $tree.find('tr:last-child');

        for(var i=0; i<tree.children.length; i++) {
            var $td = $('<td/>');
            $td.append(
                drawTree(tree.children[i])
            );

            $tr.append($td);
        }

        return $tree;

      default:          // Custom behavior and decorators
                        // lookup trees in the behavior tree library.
        var invert=tree.id.charAt(0)==='!';
        var realId=invert?tree.id.slice(1):tree.id;
        var subtree=Behavior.Library[realId];
        if(subtree && 1) {  // should we expand this tree?
            return drawTree(subtree);
        } else {
            return $('<div class="node">'+tree.id+'</div>');
        }
    }
}

$(function(){
    var testTree = Behavior.Library.Infantry;
    $(document.body).append(drawTree(testTree));
});
</script></html>
